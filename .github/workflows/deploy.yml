on:
  push:
    branches:
      - '**' # matches every branch

jobs:
  Deploy:
    runs-on: ubuntu-latest
    steps:
      - name: checkout action
        uses: actions/checkout@v2
        with:
          repository: searchspring/snap-publish
      - name: Run @searchspring/snap-publish action
        uses: ./
        with:
        # required
          repository: ${{ env.GITHUB_REPOSITORY }}
          secretKey: ${{ env.WEBSITE_SECRET_KEY }}
          aws-access-key-id: ${{ secrets.SNAPFU_AWS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.SNAPFU_AWS_SECRET_ACCESS_KEY }}
          aws-cloudfront-distribution-id: ${{secrets.SNAPFU_AWS_DISTRIBUTION_ID}}
          aws-s3-bucket-name: ${{secrets.SNAPFU_AWS_BUCKET}}
        # optional
          NODE_AUTH_TOKEN: ${{ secrets.PACKAGE_TOKEN }} # TODO: remove once Snap is public
          skipTests: true # TODO: remove when we want tests to run
